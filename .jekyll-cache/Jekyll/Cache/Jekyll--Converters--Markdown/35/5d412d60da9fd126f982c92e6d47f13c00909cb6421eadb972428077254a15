I"µ<p><img src="/images/vennbar2-1.png" style="width:100%" align="middle" /></p>

<p><a href="https://en.wikipedia.org/wiki/Venn_diagram">Venn diagrams</a> are a type
of figure that I see a lot in the published literature. While Venn
diagrams are a great way to <em>conceptualize</em> the goal of looking for
shared or unique transcriptional responses to experimental
manipulations, I don‚Äôt think they are the best way to <em>vizualize
empirical data</em>.</p>

<p>I searched for ‚ÄúVenn‚Äù in Garrett Grolemund &amp; Hadley Wickham‚Äôs <a href="https://r4ds.had.co.nz/">R for
Data Science</a> book and in Claus Wilke‚Äôs
<a href="https://serialmentor.com/dataviz/">Fundamentals of Data Visualization</a>
book, for guidance alternatives to the Venn diagram. Neither book
discusses Venn diagrams, but they both provide valuable insight into
creating bar plots. Interestingly, the R for Data Science book does use
Venn diagrams to illustrate the differences between <code class="language-plaintext highlighter-rouge">inner_join</code> and
<code class="language-plaintext highlighter-rouge">full_join</code>, so that provides some evidence that Venn diagrams are
useful for conceptualizing ideas about data.)</p>

<p>The <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4720993/">UpSet plot</a>
has gained some popularity since 2016. I‚Äôve made a handful of UpSet
plots with <a href="https://github.com/hms-dbmi/UpSetR"><code class="language-plaintext highlighter-rouge">upsetR</code></a>. While it is
<em>possible</em> to modify the aesthetics of an UpSet plot, it is <em>very
challenging</em> to manipulate the size, shape, colors, and font to the
degree that is needed to combine many plots into one multi-panel figure
for a manuscript.</p>

<p><img src="/images/upsetR.png" style="width:100%" align="middle" /></p>

<p>I quite like the bar charts in the UpSet plot, so I set out to
recreate them with <a href="https://ggplot2.tidyverse.org/"><code class="language-plaintext highlighter-rouge">ggplot2</code></a> and
<a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"><code class="language-plaintext highlighter-rouge">cowplot</code></a>. Here, I convert 12 Venn diagrams from published research
articles (from labs that I admire and respect) to 4 bar plots that I made with <code class="language-plaintext highlighter-rouge">tidyverse</code> and <code class="language-plaintext highlighter-rouge">cowplot</code>. I
think these bar plots are simple, flexible, effect, and reproducibility alternatives than a Venn diagram. You can explore all the code in my <a href="https://github.com/raynamharris/vennbar">vennbar repository on
GitHub</a>, and you can run the code in the cloud with <a href="https://mybinder.org/v2/gh/raynamharris/vennbar/master?urlpath=rstudio">Binder</a>.</p>

<p><img src="/images/toth-original-alt-1.png" style="width:100%" align="middle" /></p>

<p><strong>Example 1</strong> (above) is from <a href="http://jeb.biologists.org/content/220/12/2149">Cognitive specialization for learning faces is
associated with shifts in the brain transcriptome of a social wasp by
Berens <em>et al</em>. 2017</a>. In
this example, the circles do not represent a meaningful quantity. A
stacked bar plot can use color, space, and text to highlight patterns in
the data, which in this case appears to be a greater overlap than
expected. I wanted to make the bar plot mirror the Venn diagram as
closely as possible, but I changed the order of the factors so that
‚Äúboth‚Äù category was plotted first. This was necessary for adding text to
the bar chart because the values for <em>P. metricus</em> and both were
overlapping when I kept the ‚Äúboth‚Äù category in the middle. <a href="https://github.com/raynamharris/vennbar/blob/master/examples/toth2017/toth-venn.md">Here is the
code</a>
for my bar plot alternative.</p>

<p><img src="/images/geffre-original-alt-1.png" style="width:100%" align="middle" /></p>

<p><strong>Example 2</strong> is from <a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2017.0029">Transcriptomics of an extended phenotype:
parasite manipulation of wasp social behaviour shifts expression of
caste-related genes by Geffre <em>et
al.</em></a>.
As with example 1, the proportions of the circles are all equivalent, so they don‚Äôt convey any meaning
about the size of the sets they represent. The bar chart really highlights that fact
that that ‚Äúworker versus gyne‚Äù (or ‚ÄúWorkGyne‚Äù for short) comparison
yields the most differentially expressed genes. However, that was not
the main message of the Venn diagram. The authors used an arrow an <code class="language-plaintext highlighter-rouge">*</code>
to highlight one particular comparison, so I used a bright red fill to
highlight the parasite manipulation candidate genes. <a href="https://github.com/raynamharris/vennbar/blob/master/examples/geffre2017/geffre-venn.md">Here is the
code</a>
for my bar plot alternative.</p>

<p><img src="/images/calisi-original-alt-1.png" style="width:100%" align="middle" /></p>

<p><strong>Example 3</strong> is from <a href="https://www.sciencedirect.com/science/article/pii/S0018506X17302696?via%3Dihub">Sex-biased transcriptomic response of the
reproductive axis to stress by Calisi et
al.¬†2017</a>.
This weighted Venn diagram is the highest quality Venn diagram I‚Äôve ever
seen, but it still has limitations. If you only focus on the green pies,
they seem to do a good job of conveying relative size, but if you look
closely, you‚Äôll notices that the size of the grey circles is misleading.
The original Venn diagram conveys information about tissue
(hypothalamus, pituitary, gonad), sex (male and female), and response
(up- or down-regulation), so I used facetting and a combination of
stacked and side-by-side bar plot to visualize all the complexity. I
think that this bar chart does a better job of conveying the magnitude
of differences between the sexes and across tissues and the bias toward
up-regulation of gene expression. <a href="https://github.com/raynamharris/vennbar/blob/master/examples/calisi2017/calisi-venn.md">Here is the
code</a>
for my bar plot alternative, as well as a less-squished version of the
bar plot.</p>

<p><img src="/images/pena-original-alt-1.png" style="width:100%" align="middle" /></p>

<p><strong>Example 4</strong> is from <a href="https://www.biorxiv.org/content/10.1101/624353v1">Early life stress alters transcriptomic
patterning across reward circuitry in male and female mice by Pe√±a <em>et
al.</em> 2017</a>. Here, the
Venn diagrams are also scaled, but each of the six subplots has their
own scaling, so you cannot compare all six visually. Moreover, the
authors report the <em>percent</em> of shared gene expression in the
manuscript, but their Venn diagrams show <em>counts</em>. So, I calculated the
percent of shared differentially expressed genes (%DEGs) and colored all
overlapping responses in shades of purple and the unique responses in
shades of orange. Now, once can spot interesting trends in the data,
like increase response to early and late life stress (ELS + STVS) in the
female PFC. This is something that is present but not emphasized in the
Venn. <a href="https://github.com/raynamharris/vennbar/blob/master/examples/pena2019/pena-venn.md">Here is the
code</a>
for my bar plot alternative.</p>

<p>So, that‚Äôs my comparison of four Venn diagrams and four possible bar
plot alternatives. What do you think? Do you see the advantages? What
other alternatives do you suggest? Comments welcome! (<em>Thanks to Titus Brown, Claus, Wilke, and Victoria Farrar for insightful comments on an earlier draft.</em>)</p>

<h2 id="references">References</h2>

<ol>
  <li>Berens <em>et al</em>. 2017: http://jeb.biologists.org/content/220/12/2149</li>
  <li>Geffre <em>et
al.</em> 2017: https://royalsocietypublishing.org/doi/full/10.1098/rspb.2017.0029</li>
  <li>Calisi <em>et
al.</em>¬†2017: https://www.sciencedirect.com/science/article/pii/S0018506X17302696?via%3Dihub)</li>
  <li>Pe√±a <em>et
al.</em> 2019: https://www.biorxiv.org/content/10.1101/624353v1</li>
</ol>
:ET